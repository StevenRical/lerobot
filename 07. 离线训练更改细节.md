### (1). å…³é—­è”ç½‘ä¸‹è½½ä»£ç 

a. ä¿®æ”¹**`lerobot/common/datasets/factory.py`** é‡Œçš„ **`make_dataset` --> `make_dataset_offline `**ï¼ˆæ–°å†™ä¸€ä¸ªå‡½æ•°ï¼‰

**æ·»åŠ ` local_files_only=True`**

```
    if isinstance(cfg.dataset_repo_id, str):
        # TODO (aliberts): add 'episodes' arg from config after removing hydra
        dataset = LeRobotDataset(
            cfg.dataset_repo_id,
            delta_timestamps=cfg.training.get("delta_timestamps"),
            image_transforms=image_transforms,
            video_backend=cfg.video_backend,
            local_files_only=True,  # âœ… å…³é”®ï¼šç¡®ä¿åªç”¨æœ¬åœ°æ•°æ®
        )
    else:
        dataset = MultiLeRobotDataset(
            cfg.dataset_repo_id,
            delta_timestamps=cfg.training.get("delta_timestamps"),
            image_transforms=image_transforms,
            video_backend=cfg.video_backend,
            local_files_only=True,  # âœ… å…³é”®ï¼šç¡®ä¿åªç”¨æœ¬åœ°æ•°æ®
        )
```

------

b. ä¿®æ”¹ **`lerobot/scripts/train.py`** ï¼ˆå¤‡ä»½æˆ**`lerobot/scripts/train_offline.py`** æ¥ä¿®æ”¹ï¼‰

æ‰¾åˆ°ä»£ç 

```
offline_dataset = make_dataset(cfg)
```

æ”¹æˆ

```
from lerobot.common.datasets.factory import make_dataset, resolve_delta_timestamps, make_dataset_offline


offline_dataset = make_dataset_offline(cfg)
```

------

c. æ·»åŠ æ¡ä»¶é€€å‡ºè¯­å¥

```
if self.local_files_only:
    logging.info("ğŸ“‚ ä»…ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ï¼Œè·³è¿‡ XXXXX ")
    return
```

åœ¨**`lerobot/common/datasets/lerobot_dataset.py`** ä¿®æ”¹ **`pull_from_repo()`**  

æ³¨æ„ä¸¤ä¸ªç±»é‡Œéƒ½æœ‰è¿™ä¸ªå‡½æ•°ï¼`LeRobotDataset` ã€`LeRobotDatasetMetadata`

```
def pull_from_repo(
    self,
    allow_patterns: list[str] | str | None = None,
    ignore_patterns: list[str] | str | None = None,
) -> None:
    if self.local_files_only:
        logging.info("ğŸ“‚ ä»…ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ï¼Œè·³è¿‡ pull_from_repo()")
        return
    snapshot_download(
        self.repo_id,
        repo_type="dataset",
        revision=self._hub_version,
        local_dir=self.root,
        allow_patterns=allow_patterns,
        ignore_patterns=ignore_patterns,
        local_files_only=self.local_files_only,
    )
```

åœ¨**`lerobot/common/datasets/lerobot_dataset.py`** ä¿®æ”¹ **`download_episodes()`**

```
def download_episodes(self, download_videos: bool = True) -> None:
    if self.local_files_only:
        logging.info("ğŸ“‚ ä»…ä½¿ç”¨æœ¬åœ°æ•°æ®ï¼Œè·³è¿‡ `download_episodes()`")
        return
    ignore_patterns = None if download_videos else "videos/"
    self.pull_from_repo(allow_patterns=None, ignore_patterns=ignore_patterns)
```



### (2). æ•°æ®åŠ è½½æˆåŠŸæç¤º

åœ¨ `train_offline.py` é‡Œï¼Œ**åœ¨è°ƒç”¨ `make_dataset(cfg)` ä¹‹åï¼Œæ‰“å°æ•°æ®é›†ä¿¡æ¯**ï¼š

```
offline_dataset = make_dataset_offline(cfg)

# âœ… æµ‹è¯•æ˜¯å¦æˆåŠŸåŠ è½½æœ¬åœ°æ•°æ®
logging.info(f"ğŸ“‚ æ•°æ®é›†åŠ è½½æˆåŠŸï¼å…±æœ‰ {len(offline_dataset)} ä¸ªæ ·æœ¬ï¼Œ{offline_dataset.num_episodes} ä¸ª episodeã€‚")
```

```
INFO 2025-01-30 20:48:02 t_dataset.py:99 ğŸ“‚ ä»…ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ï¼Œè·³è¿‡ pull_from_repo()
INFO 2025-01-30 20:48:02 _dataset.py:534 ğŸ“‚ ä»…ä½¿ç”¨æœ¬åœ°æ•°æ®ï¼Œè·³è¿‡ `download_episodes()`
INFO 2025-01-30 20:48:03 _offline.py:316 ğŸ“‚ æœ¬åœ°æ•°æ®é›†åŠ è½½æˆåŠŸï¼å…±æœ‰ 1497 ä¸ªæ ·æœ¬ï¼Œ2 ä¸ª episodeã€‚
```







# 5. å…¶ä»–å‚è€ƒä¿¡æ¯ï¼ˆå…¥å‚ï¼‰



## ä¸€ã€control_robot.py



### **é€šç”¨å‚æ•°ï¼ˆé€‚ç”¨äºæ‰€æœ‰æ¨¡å¼ï¼‰**

| å‚æ•°å              | ç±»å‹  | é»˜è®¤å€¼                            | ä½œç”¨                                                         |
| ------------------- | ----- | --------------------------------- | ------------------------------------------------------------ |
| `--robot-path`      | `str` | `lerobot/configs/robot/koch.yaml` | æŒ‡å®šæœºå™¨äººé…ç½®æ–‡ä»¶è·¯å¾„ï¼Œç”¨äºé€šè¿‡ `make_robot` å·¥å‚å‡½æ•°å®ä¾‹åŒ–æœºå™¨äººã€‚ |
| `--robot-overrides` | `str` | æ—                                 | è¦†ç›–é»˜è®¤é…ç½®ä¸­çš„é”®å€¼å¯¹å‚æ•°ï¼ˆæ”¯æŒåµŒå¥—é…ç½®ï¼Œå¦‚ `key.subkey=value`ï¼‰ã€‚ |

------

### **æ ¡å‡†æ¨¡å¼ï¼ˆ`calibrate`ï¼‰**

| å‚æ•°å   | ç±»å‹  | é»˜è®¤å€¼ | ä½œç”¨                                                         |
| -------- | ----- | ------ | ------------------------------------------------------------ |
| `--arms` | `str` | æ—      | æŒ‡å®šéœ€è¦æ ¡å‡†çš„æ‰‹è‡‚åˆ—è¡¨ï¼ˆä¾‹å¦‚ï¼š`--arms left_follower right_follower`ï¼‰ã€‚ |

------

### **é¥æ§æ¨¡å¼ï¼ˆ`teleoperate`ï¼‰**

| å‚æ•°å              | ç±»å‹        | é»˜è®¤å€¼ | ä½œç”¨                                           |
| ------------------- | ----------- | ------ | ---------------------------------------------- |
| `--fps`             | `int`       | `None` | æŒ‡å®šé¥æ§æ—¶çš„å¸§ç‡ï¼ˆå¦‚æœªè®¾ç½®åˆ™ä¸é™åˆ¶å¸§ç‡ï¼‰ã€‚     |
| `--display-cameras` | `int` (0/1) | `1`    | æ˜¯å¦æ˜¾ç¤ºç›¸æœºç”»é¢ï¼ˆ1 è¡¨ç¤ºæ˜¾ç¤ºï¼Œ0 è¡¨ç¤ºä¸æ˜¾ç¤ºï¼‰ã€‚ |

------

### **è®°å½•æ¨¡å¼ï¼ˆ`record`ï¼‰**

| å‚æ•°å                                  | ç±»å‹        | é»˜è®¤å€¼         | ä½œç”¨                                                         |
| --------------------------------------- | ----------- | -------------- | ------------------------------------------------------------ |
| `--fps`                                 | `int`       | `None`         | æŒ‡å®šæ•°æ®è®°å½•æ—¶çš„å¸§ç‡ï¼ˆå¦‚æœªè®¾ç½®åˆ™ä½¿ç”¨ç­–ç•¥é…ç½®çš„å¸§ç‡ï¼‰ã€‚       |
| `--single-task`                         | `str`       | æ—              | æè¿°ä»»åŠ¡å†…å®¹ï¼ˆå•ä»»åŠ¡æ¨¡å¼ï¼‰ã€‚                                 |
| `--root`                                | `Path`      | æ—              | æ•°æ®é›†å­˜å‚¨çš„æ ¹ç›®å½•ã€‚                                         |
| `--repo-id`                             | `str`       | `lerobot/test` | æ•°æ®é›†æ ‡è¯†ç¬¦ï¼Œé€šå¸¸æ ¼å¼ä¸º `{hf_username}/{dataset_name}`ã€‚    |
| `--local-files-only`                    | `int` (0/1) | `0`            | æ˜¯å¦ä»…ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ï¼ˆ0 è¡¨ç¤ºå…è®¸ä» Hub è·å–æ•°æ®é›†ï¼Œ1 è¡¨ç¤ºä»…ä½¿ç”¨æœ¬åœ°æ•°æ®ï¼‰ã€‚ |
| `--warmup-time-s`                       | `int`       | `10`           | æ•°æ®é‡‡é›†å‰çš„é¢„çƒ­æ—¶é—´ï¼ˆç§’ï¼‰ã€‚                                 |
| `--episode-time-s`                      | `int`       | `60`           | å•æ¬¡æ•°æ®è®°å½•çš„æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰ã€‚                               |
| `--reset-time-s`                        | `int`       | `60`           | ç¯å¢ƒé‡ç½®çš„æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰ã€‚                                   |
| `--num-episodes`                        | `int`       | `50`           | æ•°æ®é‡‡é›†çš„æ€»æ¬¡æ•°ã€‚                                           |
| `--run-compute-stats`                   | `int` (0/1) | `1`            | æ˜¯å¦åœ¨é‡‡é›†ç»“æŸåè®¡ç®—æ•°æ®ç»Ÿè®¡ä¿¡æ¯ï¼ˆ1 è¡¨ç¤ºè®¡ç®—ï¼Œ0 è¡¨ç¤ºè·³è¿‡ï¼‰ã€‚ |
| `--push-to-hub`                         | `int` (0/1) | `1`            | æ˜¯å¦å°†æ•°æ®é›†ä¸Šä¼ åˆ° Hugging Face Hubï¼ˆ1 è¡¨ç¤ºä¸Šä¼ ï¼Œ0 è¡¨ç¤ºè·³è¿‡ï¼‰ã€‚ |
| `--tags`                                | `str`       | æ—              | æ·»åŠ åˆ°æ•°æ®é›†çš„æ ‡ç­¾ï¼ˆä¾‹å¦‚ï¼šä»»åŠ¡ç±»å‹ï¼‰ã€‚                       |
| `--num-image-writer-processes`          | `int`       | `0`            | å¤„ç†å¸§å›¾åƒä¿å­˜çš„å­è¿›ç¨‹æ•°é‡ï¼ˆ0 è¡¨ç¤ºä»…ä½¿ç”¨çº¿ç¨‹ï¼‰ã€‚             |
| `--num-image-writer-threads-per-camera` | `int`       | `4`            | æ¯ä¸ªæ‘„åƒå¤´ç”¨äºä¿å­˜å¸§å›¾åƒçš„çº¿ç¨‹æ•°é‡ã€‚                         |
| `--resume`                              | `int` (0/1) | `0`            | æ˜¯å¦æ¢å¤ä¹‹å‰çš„é‡‡é›†è¿›ç¨‹ï¼ˆ1 è¡¨ç¤ºæ¢å¤ï¼Œ0 è¡¨ç¤ºé‡æ–°å¼€å§‹ï¼‰ã€‚       |
| `-p, --pretrained-policy-name-or-path`  | `str`       | æ—              | æŒ‡å®šé¢„è®­ç»ƒç­–ç•¥çš„è·¯å¾„æˆ– Hub æ¨¡å‹ IDï¼Œç”¨äºæŒ‡å¯¼æœºå™¨äººåŠ¨ä½œã€‚     |
| `--policy-overrides`                    | `str`       | æ—              | è¦†ç›–ç­–ç•¥é…ç½®ä¸­çš„é”®å€¼å¯¹å‚æ•°ï¼ˆæ”¯æŒåµŒå¥—é…ç½®ï¼‰ã€‚                 |

------

### **å›æ”¾æ¨¡å¼ï¼ˆ`replay`ï¼‰**

| å‚æ•°å               | ç±»å‹        | é»˜è®¤å€¼         | ä½œç”¨                                                         |
| -------------------- | ----------- | -------------- | ------------------------------------------------------------ |
| `--fps`              | `int`       | `None`         | æŒ‡å®šå›æ”¾æ—¶çš„å¸§ç‡ï¼ˆå¦‚æœªè®¾ç½®åˆ™ä½¿ç”¨æ•°æ®é›†çš„é»˜è®¤å¸§ç‡ï¼‰ã€‚         |
| `--root`             | `Path`      | æ—              | æ•°æ®é›†å­˜å‚¨çš„æ ¹ç›®å½•ã€‚                                         |
| `--repo-id`          | `str`       | `lerobot/test` | æ•°æ®é›†æ ‡è¯†ç¬¦ï¼Œé€šå¸¸æ ¼å¼ä¸º `{hf_username}/{dataset_name}`ã€‚    |
| `--local-files-only` | `int` (0/1) | `0`            | æ˜¯å¦ä»…ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ï¼ˆ0 è¡¨ç¤ºå…è®¸ä» Hub è·å–æ•°æ®é›†ï¼Œ1 è¡¨ç¤ºä»…ä½¿ç”¨æœ¬åœ°æ•°æ®ï¼‰ã€‚ |
| `--episode`          | `int`       | `0`            | æŒ‡å®šéœ€è¦å›æ”¾çš„ä»»åŠ¡ç´¢å¼•ã€‚                                     |





## äºŒã€visualize_dataset_html.py

| å‚æ•°å               | ç±»å‹        | ä½œç”¨                                               |
| -------------------- | ----------- | -------------------------------------------------- |
| `--repo-id`          | `str`       | Hugging Face æ•°æ®é›† IDï¼ˆä¾‹å¦‚ `lerobot/pusht`ï¼‰ã€‚   |
| `--local-files-only` | `int` (0/1) | æ˜¯å¦ä»…ä½¿ç”¨æœ¬åœ°æ•°æ®ï¼ˆ1ï¼šæ˜¯ï¼Œ0ï¼šä» HF Hub åŠ è½½ï¼‰ã€‚   |
| `--root`             | `Path`      | æœ¬åœ°æ•°æ®é›†çš„å­˜å‚¨è·¯å¾„ã€‚                             |
| `--load-from-hf-hub` | `int` (0/1) | æ˜¯å¦ä» HF Hub ç›´æ¥åŠ è½½æ•°æ®ï¼ˆ1ï¼šæ˜¯ï¼Œ0ï¼šæœ¬åœ°åŠ è½½ï¼‰ã€‚ |
| `--episodes`         | `list[int]` | æŒ‡å®šè¦å¯è§†åŒ–çš„ `episodes`ï¼Œé»˜è®¤å…¨éƒ¨åŠ è½½ã€‚          |
| `--output-dir`       | `Path`      | è¾“å‡º HTML å’ŒæœåŠ¡å™¨èµ„æºçš„ç›®å½•ã€‚                     |
| `--serve`            | `int` (0/1) | æ˜¯å¦å¯åŠ¨ Web æœåŠ¡å™¨ï¼ˆ1ï¼šå¯åŠ¨ï¼Œ0ï¼šä»…ç”Ÿæˆ HTMLï¼‰ã€‚   |
| `--host`             | `str`       | æœåŠ¡å™¨ä¸»æœºåœ°å€ï¼ˆé»˜è®¤ `127.0.0.1`ï¼‰ã€‚               |
| `--port`             | `int`       | æœåŠ¡å™¨ç«¯å£å·ï¼ˆé»˜è®¤ `9090`ï¼‰ã€‚                      |
| `--force-override`   | `int` (0/1) | æ˜¯å¦åˆ é™¤å·²æœ‰çš„ `output_dir` å¹¶é‡æ–°ç”Ÿæˆæ•°æ®ã€‚       |